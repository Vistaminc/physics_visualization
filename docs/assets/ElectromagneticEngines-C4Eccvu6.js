var je=Object.defineProperty;var xe=(u,e,t)=>e in u?je(u,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):u[e]=t;var m=(u,e,t)=>xe(u,typeof e!="symbol"?e+"":e,t);import{S as Ue,C as Ee,P as He,W as We,A as qe,D as fe,m as j,n as se,o as H,f as w,T as Ce,h as C,p as ve,V as U,B as x,L as De,i as Ae,F as et,q as tt,r as it,H as nt,d as st,M as B,s as ye,E as Me,t as at,u as ot,v as Ve,b as W,a as Re,w as me,c as pe,x as rt,y as ze}from"./three.module-B_RPcjEZ.js";import{O as _e}from"./OrbitControls-BbrUZaix.js";import{a as lt,r as A,l as ut,n as dt,a3 as Ie,a8 as ht,_ as ct,b as O,e as p,h as G,f as y,w as k,g as ae,a9 as Ge,aa as Le,j as ge,t as R,o as Z}from"./index-B25jyehn.js";class mt{constructor(e){m(this,"scene");m(this,"camera");m(this,"renderer");m(this,"controls");m(this,"container");m(this,"model",null);m(this,"animationId",null);m(this,"isRunning",!1);m(this,"rotationSpeed",.01);m(this,"magneticFieldStrength",5);m(this,"coilTurns",5);m(this,"showField",!0);m(this,"experimentType","motor");m(this,"onDataUpdate",null);m(this,"animate",()=>{if(this.animationId=requestAnimationFrame(this.animate),this.controls.update(),this.isRunning&&this.model){const e=this.model.children[1];e&&(e.rotation.z+=this.rotationSpeed,this.calculateData(e.rotation.z))}this.renderer.render(this.scene,this.camera)});this.container=e,this.scene=new Ue,this.scene.background=new Ee(15790320),this.camera=new He(75,e.clientWidth/e.clientHeight,.1,1e3),this.camera.position.set(5,5,5),this.renderer=new We({antialias:!0}),this.renderer.setSize(e.clientWidth,e.clientHeight),this.renderer.shadowMap.enabled=!0,e.appendChild(this.renderer.domElement),this.controls=new _e(this.camera,this.renderer.domElement),this.controls.enableDamping=!0,this.addLights(),this.animate(),window.addEventListener("resize",this.handleResize.bind(this))}addLights(){const e=new qe(4210752,1);this.scene.add(e);const t=new fe(16777215,1);t.position.set(10,10,10),t.castShadow=!0,t.shadow.mapSize.width=1024,t.shadow.mapSize.height=1024,this.scene.add(t);const i=new fe(16777215,.5);i.position.set(-5,5,-5),this.scene.add(i)}createModel(){this.model&&(this.scene.remove(this.model),this.disposeModel(this.model)),this.model=new j,this.experimentType==="motor"?this.createMotorModel():this.createGeneratorModel(),this.scene.add(this.model)}createMotorModel(){if(!this.model)return;const e=new se(2,2,3,32),t=new H({color:10066329,transparent:!0,opacity:.7}),i=new w(e,t);i.castShadow=!0,i.receiveShadow=!0,this.model.add(i);const s=new se(1,1,3.2,32),a=new H({color:3355443}),n=new w(s,a);n.rotation.x=Math.PI/2,n.castShadow=!0,n.receiveShadow=!0,this.model.add(n);const o=new H({color:13369344}),r=Math.max(2,Math.min(8,this.coilTurns));for(let V=0;V<r;V++){const z=new Ce(.8,.1,16,100),q=new w(z,o);q.position.y=-1.2+V*(2.4/(r-1)),q.rotation.x=Math.PI/2,q.castShadow=!0,n.add(q)}const h=new se(.2,.2,6,16),c=new H({color:14737632}),l=new w(h,c);l.rotation.z=Math.PI/2,l.castShadow=!0,n.add(l);const d=.5*(this.magneticFieldStrength/5),g=new C(d,2.5,2),f=new H({color:204}),S=new H({color:13369344}),v=new w(g,f);v.position.set(2,0,0),v.castShadow=!0,this.model.add(v);const F=new w(g,S);F.position.set(-2,0,0),F.castShadow=!0,this.model.add(F),this.showField&&this.addMagneticField();const D=new C(6,.5,4),E=new H({color:6323595}),M=new w(D,E);M.position.y=-2,M.receiveShadow=!0,this.model.add(M)}createGeneratorModel(){if(!this.model)return;const e=new se(2,2,3,32),t=new H({color:6724044,transparent:!0,opacity:.7}),i=new w(e,t);i.castShadow=!0,i.receiveShadow=!0,this.model.add(i);const s=new se(1,1,3.2,32),a=new H({color:3355443}),n=new w(s,a);n.rotation.x=Math.PI/2,n.castShadow=!0,n.receiveShadow=!0,this.model.add(n);const o=.4*(this.magneticFieldStrength/5),r=new C(o,.8,2),h=new H({color:204}),c=new H({color:13369344});for(let E=0;E<4;E++){const M=E*Math.PI/2,V=new w(r,E%2===0?h:c);V.position.set(Math.cos(M)*.8,Math.sin(M)*.8,0),V.rotation.z=M,V.castShadow=!0,n.add(V)}const l=new H({color:13395456}),d=Math.max(2,Math.min(8,this.coilTurns));for(let E=0;E<d;E++){const M=E*(Math.PI*2/d),V=new Ce(.6,.15,16,100),z=new w(V,l);z.position.set(Math.cos(M)*1.6,Math.sin(M)*1.6,0),z.rotation.z=M,z.rotation.y=Math.PI/2,z.castShadow=!0,this.model.add(z)}const g=new se(.2,.2,6,16),f=new H({color:14737632}),S=new w(g,f);S.rotation.z=Math.PI/2,S.castShadow=!0,n.add(S),this.showField&&this.addMagneticField();const v=new C(6,.5,4),F=new H({color:6323595}),D=new w(v,F);D.position.y=-2,D.receiveShadow=!0,this.model.add(D)}addMagneticField(){if(!this.model)return;const e=[],t=Math.max(10,Math.min(30,this.magneticFieldStrength*4));for(let i=0;i<t;i++){const s=i/t*Math.PI*2,a=2.5;if(this.experimentType==="motor"){const n=new ve(new U(2,0,Math.sin(s)*a),new U(1,0,Math.sin(s)*a*.8),new U(-1,0,Math.sin(s)*a*.8),new U(-2,0,Math.sin(s)*a));e.push(n)}else{const n=new ve(new U(Math.cos(s)*a*.4,Math.sin(s)*a*.4,0),new U(Math.cos(s)*a*.6,Math.sin(s)*a*.6,0),new U(Math.cos(s)*a*.8,Math.sin(s)*a*.8,0),new U(Math.cos(s)*a,Math.sin(s)*a,0));e.push(n)}}e.forEach(i=>{var r;const s=i.getPoints(50),a=new x().setFromPoints(s),n=new De({color:35071,transparent:!0,opacity:.6*(this.magneticFieldStrength/10+.4)}),o=new Ae(a,n);(r=this.model)==null||r.add(o)})}startAnimation(){this.isRunning=!0}pauseAnimation(){this.isRunning=!1}resetExperiment(){if(this.isRunning=!1,this.model){const e=this.model.children[1];e&&(e.rotation.z=0)}this.onDataUpdate&&this.onDataUpdate({current:0,output:0,power:0,efficiency:0})}setParameters(e){let t=!1;e.experimentType!==void 0&&e.experimentType!==this.experimentType&&(this.experimentType=e.experimentType,t=!0),e.rotationSpeed!==void 0&&(this.rotationSpeed=e.rotationSpeed*.005),e.magneticFieldStrength!==void 0&&e.magneticFieldStrength!==this.magneticFieldStrength&&(this.magneticFieldStrength=e.magneticFieldStrength,t=!0),e.coilTurns!==void 0&&e.coilTurns!==this.coilTurns&&(this.coilTurns=e.coilTurns,t=!0),e.showField!==void 0&&e.showField!==this.showField&&(this.showField=e.showField,t=!0),t&&this.createModel()}setDataUpdateCallback(e){this.onDataUpdate=e}calculateData(e){if(!this.onDataUpdate)return;const t=Math.sin(e*4)*.1;if(this.experimentType==="motor"){const i=this.rotationSpeed*200*(1+t),s=i*this.magneticFieldStrength*.02*(1+t*.5),a=60+i*this.magneticFieldStrength*10,n=s*a/9.55,o=75+this.magneticFieldStrength/10*15-this.rotationSpeed*500*.1;this.onDataUpdate({current:i,output:s,power:n,efficiency:o})}else{const i=this.rotationSpeed*2e3*(1+t*.2),s=i*this.magneticFieldStrength*.005*(1+t),a=s/10,n=s*a,o=70+this.magneticFieldStrength/10*20-a*10;this.onDataUpdate({current:i,output:s,power:n,efficiency:o})}}handleResize(){if(!this.container)return;const e=this.container.clientWidth,t=this.container.clientHeight;this.camera.aspect=e/t,this.camera.updateProjectionMatrix(),this.renderer.setSize(e,t)}disposeModel(e){if(e){for(;e.children.length>0;)this.disposeModel(e.children[0]),e.remove(e.children[0]);e instanceof w&&(e.geometry&&e.geometry.dispose(),e.material&&(Array.isArray(e.material)?e.material.forEach(t=>t.dispose()):e.material.dispose()))}}dispose(){this.animationId!==null&&(cancelAnimationFrame(this.animationId),this.animationId=null),window.removeEventListener("resize",this.handleResize.bind(this)),this.model&&this.disposeModel(this.model),this.scene.clear(),this.renderer&&(this.renderer.dispose(),this.container&&this.renderer.domElement&&this.container.removeChild(this.renderer.domElement)),this.controls&&this.controls.dispose()}}class pt{constructor(e){m(this,"scene");m(this,"camera");m(this,"renderer");m(this,"controls");m(this,"container");m(this,"model",null);m(this,"animationId",null);m(this,"magneticFieldLines",[]);m(this,"particleSystem",null);m(this,"particlesEDS",null);m(this,"particlesEMS",null);m(this,"time",0);m(this,"trainPosition",0);m(this,"trainVelocity",0);m(this,"trainAcceleration",0);m(this,"trainTargetSpeed",0);m(this,"trainStability",.95);m(this,"trainMesh",null);m(this,"activatedCoils",new Set);m(this,"isRunning",!1);m(this,"trainSpeed",10);m(this,"fieldStrength",5);m(this,"trackType","EDS");m(this,"showField",!0);m(this,"levitationHeight",5);m(this,"onDataUpdate",null);m(this,"animate",()=>{this.animationId=requestAnimationFrame(this.animate),this.controls.update(),this.isRunning&&(this.time+=.016,this.updatePhysics(),this.updateParticles(),this.updateTrackElements(),this.updateMagneticField(),this.calculateData()),this.renderer.render(this.scene,this.camera)});this.container=e,this.scene=new Ue;const t=new Ee(11789820);new Ee(10868391),this.scene.background=t,this.scene.fog=new et(t,20,100),this.camera=new He(75,e.clientWidth/e.clientHeight,.1,1e3),this.camera.position.set(10,5,15),this.renderer=new We({antialias:!0}),this.renderer.setSize(e.clientWidth,e.clientHeight),this.renderer.shadowMap.enabled=!0,this.renderer.shadowMap.type=tt,this.renderer.toneMapping=it,this.renderer.toneMappingExposure=1.2,e.appendChild(this.renderer.domElement),this.controls=new _e(this.camera,this.renderer.domElement),this.controls.enableDamping=!0,this.controls.dampingFactor=.05,this.controls.target.set(0,0,0),this.controls.maxPolarAngle=Math.PI*.85,this.addLights(),this.animate(),window.addEventListener("resize",this.handleResize.bind(this))}addLights(){const e=new qe(4210752,.5);this.scene.add(e);const t=new fe(16777184,1.2);t.position.set(10,15,10),t.castShadow=!0,t.shadow.mapSize.width=2048,t.shadow.mapSize.height=2048;const i=30;t.shadow.camera.left=-30,t.shadow.camera.right=i,t.shadow.camera.top=i,t.shadow.camera.bottom=-30,t.shadow.camera.near=.5,t.shadow.camera.far=50,t.shadow.bias=-1e-4,this.scene.add(t);const s=new fe(14743551,.4);s.position.set(-5,5,-5),this.scene.add(s);const a=new nt(11789820,10868391,.6);a.position.set(0,20,0),this.scene.add(a);const n=new st(200,200),o=new B({color:10868391,roughness:.8,metalness:0}),r=new w(n,o);r.rotation.x=-Math.PI/2,r.position.y=-2.5,r.receiveShadow=!0,this.scene.add(r)}createModel(){this.model&&(this.scene.remove(this.model),this.disposeModel(this.model)),this.particleSystem&&(this.scene.remove(this.particleSystem),this.disposeParticles()),this.particlesEDS&&(this.scene.remove(this.particlesEDS),this.particlesEDS.geometry.dispose(),this.particlesEDS.material.dispose(),this.particlesEDS=null),this.particlesEMS&&(this.scene.remove(this.particlesEMS),this.particlesEMS.geometry.dispose(),this.particlesEMS.material.dispose(),this.particlesEMS=null);for(const e of this.magneticFieldLines)this.scene.remove(e),e.geometry.dispose(),e.material.dispose();this.magneticFieldLines=[],this.model=new j,this.activatedCoils=new Set,this.createMaglevTrainModel(),this.scene.add(this.model),this.addEnvironment()}addEnvironment(){if(!this.model)return;const e=new j,t=30,i=[9479342,7901340,6323595,5533306];for(let s=0;s<t;s++){const a=Math.random()*15+5,n=Math.random()*3+1,o=Math.random()*3+1,r=new C(n,a,o),h=new B({color:i[Math.floor(Math.random()*i.length)],roughness:.7,metalness:.2}),c=new w(r,h);c.position.x=(Math.random()-.5)*100,c.position.y=a/2-2.5,c.position.z=-30-Math.random()*30,c.castShadow=!0,c.receiveShadow=!0,e.add(c)}this.scene.add(e)}createMaglevTrainModel(){this.model&&(this.createTrack(),this.createTrain(),this.showField&&this.addMagneticField(),this.trainTargetSpeed=this.trainSpeed*.01,this.createParticleSystems())}createTrack(){if(!this.model)return;const e=80,t=5,i=new C(e,.5,t),s=new B({color:6323595,metalness:.5,roughness:.5}),a=new w(i,s);a.position.y=-1.5,a.receiveShadow=!0,this.model.add(a);const n=20;for(let o=0;o<n;o++){const r=new C(.5,1.5,.5),h=new B({color:4545124,metalness:.5,roughness:.5}),c=new w(r,h);c.position.set(-80/2+o*(e/n),-2,0),c.castShadow=!0,c.receiveShadow=!0,this.model.add(c)}this.trackType==="EDS"?this.createEDSTrack(e):this.createEMSTrack(e)}createEDSTrack(e){if(!this.model)return;const t=80,i=e/t,s=new B({color:870305,metalness:.9,roughness:.2,emissive:0}),a=new B({color:2733814,metalness:.9,roughness:.2,emissive:2733814,emissiveIntensity:.5});for(let n=0;n<t;n++){const o=new Ce(.4,.05,12,24),r=new w(o,s.clone());r.position.x=-e/2+.5+n*i,r.position.y=-1.1,r.rotation.x=Math.PI/2,r.castShadow=!0,r.receiveShadow=!0,r.userData={isCoil:!0,index:n,originalMaterial:r.material,activeMaterial:a.clone()},this.model.add(r)}}createEMSTrack(e){if(!this.model)return;const t=new B({color:15094016,metalness:.5,roughness:.3,emissive:0}),i=new B({color:16750592,metalness:.5,roughness:.3,emissive:16750592,emissiveIntensity:.5}),s=new C(e,.2,1.5),a=new w(s,t);a.position.y=-1.1,a.castShadow=!0,a.receiveShadow=!0,this.model.add(a);const n=new C(e,.8,.3),o=new w(n,t);o.position.y=-.7,o.castShadow=!0,o.receiveShadow=!0,this.model.add(o);const r=40,h=e/r;for(let c=0;c<r;c++){const l=new C(.6,.1,1),d=new w(l,t.clone());d.position.x=-e/2+.5+c*h,d.position.y=-.3,d.castShadow=!0,d.receiveShadow=!0,d.userData={isMagnet:!0,index:c,originalMaterial:d.material,activeMaterial:i.clone()},this.model.add(d)}}createTrain(){if(!this.model)return;const e=new j,t=8,i=2.4,s=2,a=new B({color:16119285,metalness:.6,roughness:.3,envMapIntensity:.8}),n=new ye;n.moveTo(-8/2+1,-2/2),n.lineTo(t/2-1,-2/2),n.lineTo(t/2-1,s/2),n.lineTo(-8/2+1,s/2),n.lineTo(-8/2+1,-2/2);const o={steps:1,depth:i,bevelEnabled:!0,bevelThickness:.1,bevelSize:.4,bevelOffset:0,bevelSegments:6},r=new Me(n,o);r.rotateY(Math.PI/2),r.translate(0,0,-2.4/2);const h=new w(r,a);h.position.y=this.levitationHeight/5-.2,h.castShadow=!0,h.receiveShadow=!0,e.add(h);const c=new j,l=new B({color:16119285,metalness:.7,roughness:.2,envMapIntensity:1}),d=new ye;d.moveTo(0,0),d.lineTo(2,0),d.lineTo(0,1.2),d.lineTo(0,0);const g={steps:2,depth:i,bevelEnabled:!1},f=new Me(d,g);f.rotateX(Math.PI/2),f.rotateZ(Math.PI/2),f.translate(t/2-1,s/2,-2.4/2);const S=new w(f,l);S.castShadow=!0,S.receiveShadow=!0,c.add(S);const v=new ye;v.moveTo(0,0),v.lineTo(2,0),v.lineTo(0,-.8),v.lineTo(0,0);const F={steps:2,depth:i,bevelEnabled:!1},D=new Me(v,F);D.rotateX(-Math.PI/2),D.rotateZ(-Math.PI/2),D.translate(t/2-1,-2/2,-2.4/2);const E=new w(D,l);E.castShadow=!0,E.receiveShadow=!0,c.add(E);const M=new B({color:2171169,metalness:.5,roughness:.5}),V=new C(.1,1.6,i),z=new w(V,M);z.position.set(t/2+.85,0,0),z.castShadow=!0,z.receiveShadow=!0,c.add(z),e.add(c);const q=new B({color:this.trackType==="EDS"?4149685:16733986,metalness:.8,roughness:.2,emissive:this.trackType==="EDS"?3162015:14172949,emissiveIntensity:.3}),J=new C(t,.3,i+.02),T=new w(J,q);T.position.y=this.levitationHeight/5-.2,T.castShadow=!0,T.receiveShadow=!0,e.add(T);const b=new at({color:9489145,metalness:.2,roughness:.1,transparent:!0,opacity:.9,transmission:.4,clearcoat:1,clearcoatRoughness:.1}),L=new C(.1,.8,1.8),P=new w(L,b);P.position.set(t/2+.85,.3,0),P.castShadow=!1,P.receiveShadow=!0,e.add(P);const ee=8,te=.8,we=.6,Se=(t-2)/ee;for(let X=0;X<ee;X++){const N=-2.5+X*Se,Y=new C(.1,we,te),K=new w(Y,b);K.position.set(N,.3,i/2+.05),K.castShadow=!1,K.receiveShadow=!0,e.add(K);const Q=K.clone();Q.position.z=-2.4/2-.05,e.add(Q)}const oe=new B({color:10395294,metalness:.9,roughness:.4}),re=new C(2,.3,1.6),$=new w(re,oe);$.position.set(0,s/2+.15,0),$.castShadow=!0,$.receiveShadow=!0,e.add($);const Fe=new C(.6,.1,1),ie=new w(Fe,oe);ie.position.set(-8/4,s/2+.05,0),ie.castShadow=!0,ie.receiveShadow=!0,e.add(ie);const _=new j;_.position.set(-8/4,s/2+.05,0);const ne=new B({color:4342338,metalness:.9,roughness:.5}),I=new C(.5,.05,.05),le=new w(I,ne);le.position.set(0,.2,.2),le.rotation.x=Math.PI/6,_.add(le);const Te=le.clone();Te.position.z=-.2,_.add(Te);const Xe=new C(.5,.05,.05),ue=new w(Xe,ne);ue.position.set(0,.5,.4),ue.rotation.x=-Math.PI/4,_.add(ue);const ke=ue.clone();ke.position.z=-.4,_.add(ke);const Ne=new C(.6,.05,.1),be=new w(Ne,new B({color:14737632,metalness:1,roughness:.3}));be.position.set(0,.7,0),_.add(be),e.add(_);const Ye=new B({color:16774557,emissive:16774557,emissiveIntensity:this.isRunning?1:.1,transparent:!0,opacity:.9}),$e=new ot(.15,16),de=new w($e,Ye);de.position.set(t/2+.9,.15,-.6),de.rotation.y=-Math.PI/2,e.add(de);const Pe=de.clone();if(Pe.position.z=.6,e.add(Pe),this.isRunning){const N=new Ve(16777184,2,20,Math.PI/6,.5,1);N.position.set(t/2+.9,.15,-.6),N.target.position.set(t/2+10,.15,-.6),e.add(N),e.add(N.target);const Y=new Ve(16777184,2,20,Math.PI/6,.5,1);Y.position.set(t/2+.9,.15,.6),Y.target.position.set(t/2+10,.15,.6),e.add(Y),e.add(Y.target)}const Oe=new B({color:this.trackType==="EDS"?6765239:16733986,metalness:.8,roughness:.2,emissive:this.trackType==="EDS"?4532128:14172949,emissiveIntensity:.3}),Ze=new C(t-1,.2,i-.4),he=new w(Ze,Oe);he.position.y=this.levitationHeight/5-.9,he.castShadow=!0,he.receiveShadow=!0,e.add(he);const Je=new B({color:15658734,metalness:.6,roughness:.3});for(let X=-1;X<=1;X+=2)for(let N=0;N<2;N++){const Y=-2+N*t/2,K=new C(.1,1.4,.8),Q=new w(K,Je);Q.position.set(Y,0,X*(i/2+.05)),Q.castShadow=!0,Q.receiveShadow=!0,e.add(Q);const Ke=new C(.12,.6,.6),ce=new w(Ke,b);ce.position.set(Y,.3,X*(i/2+.05)),ce.castShadow=!1,ce.receiveShadow=!0,e.add(ce);const Qe=new C(.12,.1,.05),Be=new w(Qe,new B({color:7697781,metalness:.9,roughness:.2}));Be.position.set(Y,-.2,X*(i/2+.1)),e.add(Be)}this.model.add(e),this.trainMesh=h}addMagneticField(){this.model&&(this.magneticFieldLines.forEach(e=>{this.scene.remove(e)}),this.magneticFieldLines=[],this.particleSystem&&this.scene.remove(this.particleSystem),this.trackType==="EDS"?this.createEDSField():this.createEMSField())}createEDSField(){var r,h;const t=new x,i=new Float32Array(1e3*3),s=new Float32Array(1e3*3);for(let c=0;c<1e3;c++){const l=Math.random()*30-15,d=(Math.random()-.7)*1.5,g=(Math.random()-.5)*3;i[c*3]=l,i[c*3+1]=d,i[c*3+2]=g;const f=(d+1.5)/3;s[c*3]=f<.5?0:(f-.5)*2,s[c*3+1]=.3,s[c*3+2]=f<.5?1-f*2:0}t.setAttribute("position",new W(i,3)),t.setAttribute("color",new W(s,3));const a=new Re({size:.05,transparent:!0,opacity:.6,vertexColors:!0,blending:me});this.particleSystem=new pe(t,a),this.scene.add(this.particleSystem);const n=Math.max(10,Math.min(30,this.fieldStrength*4)),o=((h=(r=this.model)==null?void 0:r.children.find(c=>c.position.y>-1))==null?void 0:h.position.y)||0;for(let c=0;c<n;c++){const l=-15+c*30/n,g=new ve(new U(l,-1,0),new U(l,o-1,0),new U(l,o-.5,0),new U(l,o,0)).getPoints(20),f=new x().setFromPoints(g),S=new De({color:35071,linewidth:2,transparent:!0,opacity:.6*(this.fieldStrength/10+.4)}),v=new Ae(f,S);this.magneticFieldLines.push(v),this.scene.add(v)}}createEMSField(){var h,c,l,d;const e=((c=(h=this.model)==null?void 0:h.children.find(g=>g.position.y===-.7))==null?void 0:c.position.y)||-.7,t=((d=(l=this.model)==null?void 0:l.children.find(g=>g.position.y>-1))==null?void 0:d.position.y)||0,i=Math.max(10,Math.min(30,this.fieldStrength*2));for(let g=0;g<i;g++){const f=-4+g*8/i,v=new ve(new U(f,e-.2,0),new U(f,(e+t)/2,0),new U(f,t-1,0),new U(f,t-.9,0)).getPoints(20),F=new x().setFromPoints(v),D=new De({color:16746496,linewidth:2,transparent:!0,opacity:.6*(this.fieldStrength/10+.4)}),E=new Ae(F,D);this.magneticFieldLines.push(E),this.scene.add(E)}const s=800,a=new x,n=new Float32Array(s*3),o=new Float32Array(s*3);for(let g=0;g<s;g++){const f=(Math.random()-.5)*9,S=e+(t-e)*Math.random(),v=(Math.random()-.5)*1.5;n[g*3]=f,n[g*3+1]=S,n[g*3+2]=v;const F=(S-e)/(t-e);o[g*3]=1,o[g*3+1]=.5*(1-F),o[g*3+2]=0}a.setAttribute("position",new W(n,3)),a.setAttribute("color",new W(o,3));const r=new Re({size:.05,transparent:!0,opacity:.6,vertexColors:!0,blending:me});this.particleSystem=new pe(a,r),this.scene.add(this.particleSystem)}createParticleSystems(){const t=new x,i=new Float32Array(1e3*3),s=new Float32Array(1e3),a=new Float32Array(1e3*3),n=new Float32Array(1e3);for(let v=0;v<1e3;v++)i[v*3]=0,i[v*3+1]=-100,i[v*3+2]=0,s[v]=Math.random()*.1+.05,a[v*3]=.2,a[v*3+1]=.5+Math.random()*.5,a[v*3+2]=1,n[v]=0;t.setAttribute("position",new W(i,3)),t.setAttribute("size",new W(s,1)),t.setAttribute("color",new W(a,3)),t.setAttribute("alpha",new W(n,1));const o=new rt().load("/assets/textures/particle.png"),r=new ze({uniforms:{texture:{value:o}},vertexShader:`
        attribute float size;
        attribute vec3 color;
        attribute float alpha;
        varying vec3 vColor;
        varying float vAlpha;
        
        void main() {
          vColor = color;
          vAlpha = alpha;
          vec4 mvPosition = modelViewMatrix * vec4(position, 1.0);
          gl_PointSize = size * (300.0 / -mvPosition.z);
          gl_Position = projectionMatrix * mvPosition;
        }
      `,fragmentShader:`
        uniform sampler2D texture;
        varying vec3 vColor;
        varying float vAlpha;
        
        void main() {
          vec4 texColor = texture2D(texture, gl_PointCoord);
          gl_FragColor = vec4(vColor, vAlpha) * texColor;
        }
      `,transparent:!0,depthWrite:!1,blending:me});this.particlesEDS=new pe(t,r),this.scene.add(this.particlesEDS);const h=800,c=new x,l=new Float32Array(h*3),d=new Float32Array(h),g=new Float32Array(h*3),f=new Float32Array(h);for(let v=0;v<h;v++)l[v*3]=0,l[v*3+1]=-100,l[v*3+2]=0,d[v]=Math.random()*.1+.05,g[v*3]=1,g[v*3+1]=.5+Math.random()*.3,g[v*3+2]=0,f[v]=0;c.setAttribute("position",new W(l,3)),c.setAttribute("size",new W(d,1)),c.setAttribute("color",new W(g,3)),c.setAttribute("alpha",new W(f,1));const S=new ze({uniforms:{texture:{value:o}},vertexShader:`
        attribute float size;
        attribute vec3 color;
        attribute float alpha;
        varying vec3 vColor;
        varying float vAlpha;
        
        void main() {
          vColor = color;
          vAlpha = alpha;
          vec4 mvPosition = modelViewMatrix * vec4(position, 1.0);
          gl_PointSize = size * (300.0 / -mvPosition.z);
          gl_Position = projectionMatrix * mvPosition;
        }
      `,fragmentShader:`
        uniform sampler2D texture;
        varying vec3 vColor;
        varying float vAlpha;
        
        void main() {
          vec4 texColor = texture2D(texture, gl_PointCoord);
          gl_FragColor = vec4(vColor, vAlpha) * texColor;
        }
      `,transparent:!0,depthWrite:!1,blending:me});this.particlesEMS=new pe(c,S),this.scene.add(this.particlesEMS)}startAnimation(){this.isRunning=!0}pauseAnimation(){this.isRunning=!1}resetSimulation(){if(this.isRunning=!1,this.trainPosition=0,this.time=0,this.model){const e=this.model.children.find(i=>i.position.y>-1),t=this.model.children.find(i=>i instanceof j);e&&(e.position.x=0),t&&(t.position.x=4)}this.onDataUpdate&&this.onDataUpdate({levitationForce:0,propulsionForce:0,current:0,powerConsumption:0})}setParameters(e){let t=!1;e.height!==void 0&&e.height!==this.levitationHeight&&(this.levitationHeight=e.height,t=!0),e.speed!==void 0&&(this.trainSpeed=e.speed),e.fieldStrength!==void 0&&e.fieldStrength!==this.fieldStrength&&(this.fieldStrength=e.fieldStrength,t=!0),e.trackType!==void 0&&e.trackType!==this.trackType&&(this.trackType=e.trackType,t=!0),e.showField!==void 0&&e.showField!==this.showField&&(this.showField=e.showField,t=!0),t&&this.createModel()}setDataUpdateCallback(e){this.onDataUpdate=e}updatePhysics(){if(this.trackType==="EDS"?this.trainVelocity>.05?this.trainAcceleration=(this.trainTargetSpeed-this.trainVelocity)*.1:(this.trainAcceleration=Math.max(0,this.trainAcceleration-.001),this.trainVelocity<.05&&this.trainSpeed>0&&(this.trainAcceleration=.001*this.trainSpeed)):this.trainAcceleration=(this.trainTargetSpeed-this.trainVelocity)*.2,this.trainVelocity+=this.trainAcceleration*.016,this.trainVelocity=Math.max(0,this.trainVelocity),this.trainPosition+=this.trainVelocity*100*.016,this.trainPosition>100&&(this.trainPosition=0),this.trainMesh){this.trainMesh.position.x=-35+this.trainPosition*.7;const t=this.trainStability,i=Math.sin(this.time*5)*.05*(1-t)*(this.isRunning?1:0);let s=this.levitationHeight/5;if(this.trackType==="EDS"){const a=Math.min(1,this.trainVelocity*10);s*=a}this.trainMesh.position.y=s-.5+i}}updateParticles(){const e=this.trackType==="EDS"?this.particlesEDS:this.particlesEMS;if(!e||!this.trainMesh||!this.isRunning)return;const t=e.geometry.attributes.position.array,i=e.geometry.attributes.size.array,s=e.geometry.attributes.alpha.array,a=t.length/3,n=this.trainVelocity,o=this.trainMesh.position.x,r=this.trainMesh.position.y,h=this.trainMesh.position.z,c=this.trackType==="EDS"?Math.min(20,Math.floor(n*1e3)):Math.min(15,Math.floor(n*800));for(let l=0;l<a;l++)if(s[l]>0)this.trackType==="EDS"?(t[l*3]+=(Math.random()-.5)*.05,t[l*3+1]-=.03,t[l*3+2]+=(Math.random()-.5)*.05):(t[l*3]+=(Math.random()-.5)*.03,t[l*3+1]-=.02,t[l*3+2]+=(Math.random()-.5)*.03),s[l]-=.01,s[l]<=0&&(t[l*3]=0,t[l*3+1]=-100,t[l*3+2]=0,s[l]=0);else if(Math.random()<.1&&c>0&&l%Math.max(1,Math.floor(a/c))===0){const d=(Math.random()-.5)*3,g=Math.random()*.5,f=(Math.random()-.5)*1;t[l*3]=o+d,t[l*3+1]=r-.5+g,t[l*3+2]=h+f,s[l]=Math.random()*.5+.5,i[l]=Math.random()*.15+.05}e.geometry.attributes.position.needsUpdate=!0,e.geometry.attributes.alpha.needsUpdate=!0,e.geometry.attributes.size.needsUpdate=!0}updateTrackElements(){if(!this.model||!this.trainMesh)return;this.activatedCoils.forEach(i=>{i.material=i.userData.originalMaterial}),this.activatedCoils.clear();const e=this.trainMesh.position.x,t=10;this.model.children.forEach(i=>{var s,a;if(this.trackType==="EDS"&&((s=i.userData)!=null&&s.isCoil)||this.trackType==="EMS"&&((a=i.userData)!=null&&a.isMagnet)){const n=i.position.x;if(Math.abs(n-e)<t){let r=!1;this.trackType==="EDS"?r=this.trainVelocity>.05:r=!0,r&&(i.material=i.userData.activeMaterial,this.activatedCoils.add(i))}}})}updateMagneticField(){this.model&&(this.magneticFieldLines.forEach(e=>{this.scene.remove(e)}),this.magneticFieldLines=[],this.particleSystem&&this.scene.remove(this.particleSystem),this.trackType==="EDS"?this.createEDSField():this.createEMSField())}calculateData(){if(!this.onDataUpdate)return;const e=Math.sin(this.time*4)*.1,t=this.fieldStrength*(11-this.levitationHeight)*10*(1+e),i=this.trainSpeed*this.fieldStrength*2*(1+e*.5),s=this.fieldStrength*this.trainSpeed*.8*(1+e*.3),a=s*i*.01;this.onDataUpdate({levitationForce:t,propulsionForce:i,current:s,powerConsumption:a})}handleResize(){if(!this.container)return;const e=this.container.clientWidth,t=this.container.clientHeight;this.camera.aspect=e/t,this.camera.updateProjectionMatrix(),this.renderer.setSize(e,t)}disposeModel(e){if(e){for(;e.children.length>0;)this.disposeModel(e.children[0]),e.remove(e.children[0]);e instanceof w&&(e.geometry&&e.geometry.dispose(),e.material&&(Array.isArray(e.material)?e.material.forEach(t=>t.dispose()):e.material.dispose()))}}disposeParticles(){this.particleSystem&&(this.particleSystem.geometry.dispose(),this.particleSystem.material.dispose(),this.particleSystem=null)}dispose(){this.animationId!==null&&(cancelAnimationFrame(this.animationId),this.animationId=null),window.removeEventListener("resize",this.handleResize.bind(this)),this.model&&this.disposeModel(this.model),this.scene.clear(),this.renderer&&(this.renderer.dispose(),this.container&&this.renderer.domElement&&this.container.removeChild(this.renderer.domElement)),this.controls&&this.controls.dispose()}}class gt{constructor(e){m(this,"canvas");m(this,"context");m(this,"width");m(this,"height");m(this,"isRunning",!1);m(this,"animationFrame",null);m(this,"time",0);m(this,"experimentType","motor");m(this,"rotationSpeed",10);m(this,"magneticFieldStrength",5);m(this,"coilTurns",5);m(this,"showField",!0);m(this,"rotorAngle",0);m(this,"onDataUpdate",null);this.canvas=e;const t=e.getContext("2d");if(!t)throw new Error("无法获取 canvas 上下文");this.context=t,this.width=e.width,this.height=e.height,this.drawScene(),window.addEventListener("resize",this.handleResize.bind(this))}setParameters(e){e.experimentType!==void 0&&(this.experimentType=e.experimentType),e.rotationSpeed!==void 0&&(this.rotationSpeed=e.rotationSpeed),e.magneticFieldStrength!==void 0&&(this.magneticFieldStrength=e.magneticFieldStrength),e.coilTurns!==void 0&&(this.coilTurns=e.coilTurns),e.showField!==void 0&&(this.showField=e.showField),this.drawScene()}startAnimation(){this.isRunning||(this.isRunning=!0,this.animate())}pauseAnimation(){this.isRunning=!1,this.animationFrame!==null&&(cancelAnimationFrame(this.animationFrame),this.animationFrame=null)}resetExperiment(){this.pauseAnimation(),this.rotorAngle=0,this.time=0,this.drawScene(),this.onDataUpdate&&this.onDataUpdate({current:0,output:0,power:0,efficiency:0})}setDataUpdateCallback(e){this.onDataUpdate=e}handleResize(){this.width=this.canvas.width,this.height=this.canvas.height,this.drawScene()}animate(){this.isRunning&&(this.animationFrame=requestAnimationFrame(this.animate.bind(this)),this.time+=.016,this.rotorAngle+=this.rotationSpeed*.01,this.drawScene(),this.calculateData())}calculateData(){if(!this.onDataUpdate)return;const e=Math.sin(this.time*4)*.1;if(this.experimentType==="motor"){const t=this.rotationSpeed*2*(1+e),i=t*this.magneticFieldStrength*.02*(1+e*.5),s=60+t*this.magneticFieldStrength*10,a=i*s/9.55,n=75+this.magneticFieldStrength/10*15-this.rotationSpeed*.1;this.onDataUpdate({current:t,output:i,power:a,efficiency:n})}else{const t=this.rotationSpeed*20*(1+e*.2),i=t*this.magneticFieldStrength*.005*(1+e),s=i/10,a=i*s,n=70+this.magneticFieldStrength/10*20-s*10;this.onDataUpdate({current:t,output:i,power:a,efficiency:n})}}drawScene(){const e=this.context,t=this.width,i=this.height;e.clearRect(0,0,t,i),e.fillStyle="#f0f0f0",e.fillRect(0,0,t,i),this.experimentType==="motor"?this.drawMotor(e,t,i):this.drawGenerator(e,t,i)}drawMotor(e,t,i){const s=t/2,a=i/2,n=Math.min(t,i)*.8;e.fillStyle="#999999",e.strokeStyle="#666666",e.lineWidth=2,e.beginPath(),e.rect(s-n/4,a-n/3,n/2,n*2/3),e.fill(),e.stroke();const o=this.magneticFieldStrength/10;e.fillStyle="#0000cc",e.beginPath(),e.rect(s-n/4,a-n/3,n/10,n*2/3),e.fill(),e.stroke(),e.fillStyle="#cc0000",e.beginPath(),e.rect(s+n/4-n/10,a-n/3,n/10,n*2/3),e.fill(),e.stroke(),e.fillStyle="#ffffff",e.font=`${n/10}px Arial`,e.textAlign="center",e.textBaseline="middle",e.fillText("N",s-n/4+n/20,a),e.fillText("S",s+n/4-n/20,a),e.save(),e.translate(s,a),e.rotate(this.rotorAngle),e.fillStyle="#333333",e.beginPath(),e.arc(0,0,n/20,0,Math.PI*2),e.fill();const r=Math.max(1,Math.min(5,Math.floor(this.coilTurns/2)));for(let h=0;h<r;h++){const c=h/r*Math.PI;this.isRunning?(e.strokeStyle="#ff6666",e.shadowColor="#ff0000",e.shadowBlur=5*o):(e.strokeStyle="#cd7f32",e.shadowBlur=0),e.lineWidth=3,e.beginPath();const l=n/6,d=n/15;this.drawEllipse(e,0,0,l,d,c),e.stroke()}e.restore(),this.showField&&this.drawMagneticField(e,s,a,n,"motor")}drawGenerator(e,t,i){const s=t/2,a=i/2,n=Math.min(t,i)*.8;e.fillStyle="#6699cc",e.strokeStyle="#666666",e.lineWidth=2,e.beginPath(),e.rect(s-n/4,a-n/3,n/2,n*2/3),e.fill(),e.stroke();const o=Math.max(2,Math.min(8,this.coilTurns));for(let h=0;h<o;h++){const c=h/o*Math.PI*2,l=s+Math.cos(c)*(n/5),d=a+Math.sin(c)*(n/5);this.isRunning?(e.fillStyle="#ff9966",e.shadowColor="#ff6600",e.shadowBlur=5):(e.fillStyle="#cc6600",e.shadowBlur=0),e.beginPath(),e.arc(l,d,n/25,0,Math.PI*2),e.fill(),e.stroke()}e.save(),e.translate(s,a),e.rotate(this.rotorAngle),e.fillStyle="#333333",e.beginPath(),e.arc(0,0,n/20,0,Math.PI*2),e.fill();const r=4;for(let h=0;h<r;h++){const c=h/r*Math.PI*2,l=Math.cos(c)*(n/8),d=Math.sin(c)*(n/8);e.fillStyle=h%2===0?"#0000cc":"#cc0000",e.beginPath(),e.rect(l-n/25,d-n/15,n/12.5,n/7.5),e.fill(),e.stroke(),e.fillStyle="#ffffff",e.font=`${n/20}px Arial`,e.textAlign="center",e.textBaseline="middle",e.fillText(h%2===0?"N":"S",l,d)}e.restore(),this.showField&&this.drawMagneticField(e,s,a,n,"generator")}drawMagneticField(e,t,i,s,a){const n=this.magneticFieldStrength/10;if(e.strokeStyle="#0088ff",e.lineWidth=1,a==="motor"){const o=Math.max(5,Math.min(15,this.magneticFieldStrength*3));for(let r=0;r<o;r++){const h=(r/o-.5)*s*.5;if(e.beginPath(),e.moveTo(t-s/4,i+h),this.isRunning){const c=this.time*5+r,l=t-s/8,d=i+h+Math.sin(c)*s/20,g=t+s/8,f=i+h+Math.sin(c+Math.PI)*s/20;e.bezierCurveTo(l,d,g,f,t+s/4,i+h)}else e.lineTo(t+s/4,i+h);e.globalAlpha=.3+.7*n,e.stroke(),e.globalAlpha=1}}else{const o=Math.max(10,Math.min(20,this.magneticFieldStrength*2));for(let r=0;r<o;r++){const h=r/o*Math.PI*2,c=t+Math.cos(h)*(s/10),l=i+Math.sin(h)*(s/10),d=t+Math.cos(h)*(s/4),g=i+Math.sin(h)*(s/4);if(e.beginPath(),e.moveTo(c,l),this.isRunning){const f=this.time*3+r,S=h+Math.sin(f)*.2,v=t+Math.cos(S)*(s/6),F=i+Math.sin(S)*(s/6);e.quadraticCurveTo(v,F,d,g)}else e.lineTo(d,g);e.globalAlpha=.3+.7*n,e.stroke(),e.globalAlpha=1}}}drawEllipse(e,t,i,s,a,n=0){e.save(),e.translate(t,i),e.rotate(n),e.scale(1,a/s),e.beginPath(),e.arc(0,0,s,0,Math.PI*2),e.restore()}dispose(){this.pauseAnimation(),window.removeEventListener("resize",this.handleResize.bind(this))}}class ft{constructor(e){m(this,"canvas");m(this,"context");m(this,"width");m(this,"height");m(this,"isRunning",!1);m(this,"animationFrame",null);m(this,"time",0);m(this,"trainPosition",0);m(this,"trackSegments",24);m(this,"trackElementsArray",[]);m(this,"trainVelocity",0);m(this,"trainAcceleration",0);m(this,"trainTargetSpeed",0);m(this,"trainStability",.95);m(this,"particles",[]);m(this,"trainSpeed",10);m(this,"fieldStrength",5);m(this,"trackType","EDS");m(this,"showField",!0);m(this,"levitationHeight",5);m(this,"onDataUpdate",null);this.canvas=e;const t=e.getContext("2d");if(!t)throw new Error("无法获取 canvas 上下文");this.context=t,this.width=e.width,this.height=e.height,this.initializeTrackElements(),this.drawScene(),window.addEventListener("resize",this.handleResize.bind(this))}initializeTrackElements(){this.trackElementsArray=[];const e=this.width/this.trackSegments;for(let t=0;t<this.trackSegments;t++)this.trackElementsArray.push({x:t*e,activated:!1})}setParameters(e){e.height!==void 0&&(this.levitationHeight=e.height),e.speed!==void 0&&(this.trainSpeed=e.speed,this.trainTargetSpeed=this.trainSpeed*.01),e.fieldStrength!==void 0&&(this.fieldStrength=e.fieldStrength,this.trainStability=.85+this.fieldStrength/10*.15),e.trackType!==void 0&&(this.trackType=e.trackType),e.showField!==void 0&&(this.showField=e.showField),this.drawScene()}startAnimation(){this.isRunning||(this.isRunning=!0,this.animate())}pauseAnimation(){this.isRunning=!1,this.animationFrame!==null&&(cancelAnimationFrame(this.animationFrame),this.animationFrame=null)}resetSimulation(){this.pauseAnimation(),this.trainPosition=0,this.trainVelocity=0,this.trainAcceleration=0,this.time=0,this.particles=[],this.initializeTrackElements(),this.drawScene(),this.onDataUpdate&&this.onDataUpdate({levitationForce:0,propulsionForce:0,current:0,powerConsumption:0})}setDataUpdateCallback(e){this.onDataUpdate=e}handleResize(){this.width=this.canvas.width,this.height=this.canvas.height,this.initializeTrackElements(),this.drawScene()}animate(){this.isRunning&&(this.animationFrame=requestAnimationFrame(this.animate.bind(this)),this.time+=.016,this.updatePhysics(),this.updateParticles(),this.updateTrackElements(),this.drawScene(),this.calculateData())}updatePhysics(){this.trackType==="EDS"?this.trainVelocity>.05?this.trainAcceleration=(this.trainTargetSpeed-this.trainVelocity)*.1:(this.trainAcceleration=Math.max(0,this.trainAcceleration-.001),this.trainVelocity<.05&&this.trainSpeed>0&&(this.trainAcceleration=.001*this.trainSpeed)):this.trainAcceleration=(this.trainTargetSpeed-this.trainVelocity)*.2,this.trainVelocity+=this.trainAcceleration*.016,this.trainVelocity=Math.max(0,this.trainVelocity),this.trainPosition+=this.trainVelocity*100*.016,this.trainPosition>100&&(this.trainPosition=0)}updateParticles(){const e=this.width*.2,t=this.height*.15,i=this.trainPosition/100*(this.width-e),s=this.height*.7,a=this.levitationHeight/10*this.height*.08,n=s-t-a;if(this.isRunning&&this.trainVelocity>.01){const o=Math.floor(this.trainVelocity*this.fieldStrength*2);for(let r=0;r<o;r++)if(Math.random()>.7){const h=(Math.random()-.5)*e*.8;this.trackType==="EDS"?this.particles.push({x:i+e*.5+h,y:n+t+this.height*.02,vx:(Math.random()-.5)*.5,vy:Math.random()*2+1,life:1,maxLife:1,size:Math.random()*3+2,color:"rgba(0, 136, 255, 0.7)"}):this.particles.push({x:i+e*.5+h,y:n+t+this.height*.02,vx:(Math.random()-.5)*.3,vy:Math.random()*1.5+.5,life:1,maxLife:1,size:Math.random()*3+1.5,color:"rgba(255, 136, 0, 0.7)"})}}for(let o=this.particles.length-1;o>=0;o--){const r=this.particles[o];r.x+=r.vx,r.y+=r.vy,r.life-=.02,r.life<=0&&this.particles.splice(o,1)}}updateTrackElements(){const e=this.width*.2,t=this.trainPosition/100*(this.width-e),i=this.width*.3;for(let s of this.trackElementsArray)Math.abs(s.x-(t+e/2))<i?(s.activated=!0,this.trackType==="EDS"&&this.trainVelocity<.05&&(s.activated=!1)):s.activated=!1}calculateData(){if(!this.onDataUpdate)return;const e=Math.sin(this.time*4)*.1,t=this.trainVelocity*1e3;let i=0;if(this.trackType==="EDS"){const o=Math.min(1,this.trainVelocity*10);i=this.fieldStrength*o*(11-this.levitationHeight)*10*(1+e)}else i=this.fieldStrength*(11-this.levitationHeight)*12*(1+e);const s=t*this.fieldStrength*.2*(1+e*.5);let a=0;this.trackType==="EDS"?a=t*this.fieldStrength*.08*(1+e*.3):a=this.fieldStrength*(11-this.levitationHeight)*.5*(1+e*.2);const n=a*this.fieldStrength*.03*(this.trackType==="EDS"?t*.01:1);this.onDataUpdate({levitationForce:i,propulsionForce:s,current:a,powerConsumption:n})}drawScene(){const e=this.context,t=this.width,i=this.height;e.clearRect(0,0,t,i);const s=e.createLinearGradient(0,0,0,i*.7);s.addColorStop(0,"#B3E5FC"),s.addColorStop(1,"#E1F5FE"),e.fillStyle=s,e.fillRect(0,0,t,i*.7),this.drawCityscape(e,t,i);const a=e.createLinearGradient(0,i*.7,0,i);a.addColorStop(0,"#A5D6A7"),a.addColorStop(1,"#81C784"),e.fillStyle=a,e.fillRect(0,i*.7,t,i*.3),this.drawTrack(e,t,i),this.showField&&this.drawMagneticField(e,t,i),this.drawTrain(e,t,i),this.drawParticles(e),this.drawInfoPanel(e,t,i)}drawCityscape(e,t,i){const s=i*.7,a=Math.floor(t/40);e.fillStyle="#90A4AE";for(let n=0;n<a;n++){const o=n*t/a+Math.sin(n)*10,r=(Math.random()*.2+.05)*s,h=t/a*.8;e.fillRect(o,s-r,h,r),e.fillStyle="#ECEFF1";const c=Math.floor(r/15),l=Math.floor(h/10);for(let d=0;d<c;d++)for(let g=0;g<l;g++)Math.random()>.3&&e.fillRect(o+g*10+2,s-r+d*15+2,6,8);e.fillStyle="#90A4AE"}}drawTrack(e,t,i){const s=i*.7;e.fillStyle="#607D8B",e.fillRect(0,s,t,i*.1);const a=Math.floor(t/100);for(let n=0;n<a;n++){const o=n*(t/a);e.fillStyle="#455A64",e.beginPath(),e.rect(o-5,s,10,i*.2),e.fill()}if(this.trackType==="EDS"){const n=t/this.trackSegments;for(let o=0;o<this.trackElementsArray.length;o++){const r=this.trackElementsArray[o];r.activated?(e.fillStyle="#29B6F6",e.strokeStyle="#0288D1"):(e.fillStyle="#0D47A1",e.strokeStyle="#01579B"),e.lineWidth=2,e.beginPath(),e.rect(r.x,s-i*.02,n*.8,i*.02),e.fill(),e.stroke(),r.activated&&(e.shadowColor="#29B6F6",e.shadowBlur=10,e.beginPath(),e.rect(r.x,s-i*.02,n*.8,i*.02),e.stroke(),e.shadowBlur=0)}}else{e.fillStyle="#78909C",e.strokeStyle="#546E7A",e.lineWidth=2,e.beginPath(),e.rect(0,s-i*.02,t,i*.02),e.fill(),e.stroke(),e.beginPath(),e.rect(0,s-i*.06,t,i*.04),e.fill(),e.stroke();const n=t/this.trackSegments;for(let o=0;o<this.trackElementsArray.length;o++){const r=this.trackElementsArray[o];r.activated?(e.fillStyle="#FF9800",e.strokeStyle="#F57C00"):(e.fillStyle="#E65100",e.strokeStyle="#BF360C"),e.beginPath(),e.rect(r.x,s-i*.04,n*.8,i*.02),e.fill(),e.stroke(),r.activated&&(e.shadowColor="#FF9800",e.shadowBlur=10,e.beginPath(),e.rect(r.x,s-i*.04,n*.8,i*.02),e.stroke(),e.shadowBlur=0)}}}drawTrain(e,t,i){const s=i*.7,a=i*.15,n=t*.25,o=this.trainPosition/100*(t-n);let r=this.levitationHeight/10*i*.08;if(this.trackType==="EDS"){const T=Math.min(1,this.trainVelocity*10);r*=T}const h=this.trainStability,c=Math.sin(this.time*5)*i*.005*(1-h)*(this.isRunning?1:0),l=s-a-r+c;e.fillStyle="rgba(0, 0, 0, 0.2)",e.beginPath(),e.ellipse(o+n/2,s,n/2,n/10,0,0,Math.PI*2),e.fill(),e.fillStyle=this.trackType==="EDS"?"#673AB7":"#FF5722",e.strokeStyle=this.trackType==="EDS"?"#512DA8":"#E64A19",e.lineWidth=2,this.roundRect(e,o+t*.01,l+a-i*.02,n-t*.02,i*.02,5),e.fill(),e.stroke();const d=e.createLinearGradient(0,l+a*.85,0,l+a);d.addColorStop(0,"#E0E0E0"),d.addColorStop(1,"#BDBDBD"),e.fillStyle=d,this.roundRect(e,o+t*.005,l+a*.7,n-t*.01,a*.3-i*.02,5),e.fill(),e.strokeStyle="#9E9E9E",e.stroke();const g=e.createLinearGradient(0,l,0,l+a*.7);g.addColorStop(0,"#FAFAFA"),g.addColorStop(1,"#F5F5F5"),e.fillStyle=g;const f=a*.7;e.beginPath(),e.moveTo(o+t*.02,l+f),e.lineTo(o+n-t*.02,l+f),e.quadraticCurveTo(o+n+t*.02,l+f/2,o+n-t*.03,l+i*.02),e.lineTo(o+t*.05,l+i*.02),e.quadraticCurveTo(o-t*.01,l+f/2,o+t*.02,l+f),e.closePath(),e.fill(),e.strokeStyle="#E0E0E0",e.stroke();const S=e.createLinearGradient(o,0,o+n,0);this.trackType==="EDS"?(S.addColorStop(0,"#3F51B5"),S.addColorStop(.5,"#7986CB"),S.addColorStop(1,"#3F51B5")):(S.addColorStop(0,"#FF5722"),S.addColorStop(.5,"#FF8A65"),S.addColorStop(1,"#FF5722")),e.fillStyle=S,this.roundRect(e,o,l+f*.4,n,f*.15,3),e.fill(),e.fillStyle="#81D4FA",e.strokeStyle="#4FC3F7",e.lineWidth=1,e.beginPath(),e.moveTo(o+n-t*.03,l+i*.03),e.lineTo(o+n-t*.03,l+f*.35),e.lineTo(o+n-t*.08,l+f*.35),e.lineTo(o+n-t*.1,l+i*.03),e.closePath(),e.fill(),e.stroke(),e.fillStyle="#E3F2FD",e.strokeStyle="#BBDEFB",e.lineWidth=1;const v=5,F=t*.03,D=f*.25,E=l+i*.03,M=(n-t*.15)/v;for(let T=0;T<v;T++){const b=o+t*.1+T*M;this.roundRect(e,b,E,F,D,2),e.fill(),e.stroke()}e.strokeStyle="#E0E0E0",e.lineWidth=1;for(let T=0;T<2;T++){const b=o+t*.16+T*M*2,L=f*.55,P=l+f-L;e.beginPath(),e.moveTo(b,P),e.lineTo(b+F*1.5,P),e.lineTo(b+F*1.5,P+L),e.lineTo(b,P+L),e.closePath(),e.stroke(),e.fillStyle="#E3F2FD",this.roundRect(e,b+F*.25,P+L*.1,F,L*.4,2),e.fill(),e.stroke(),e.fillStyle="#9E9E9E",e.fillRect(b+F*1.2,P+L*.6,F*.1,L*.2)}e.fillStyle="#BDBDBD",e.beginPath();const V=o+n*.7,z=t*.04,q=i*.03;e.rect(V-z/2,l-q,z,q),e.fill(),e.strokeStyle="#9E9E9E",e.stroke(),this.isRunning?(e.fillStyle="rgba(255, 255, 200, 0.9)",e.beginPath(),e.arc(o+n-t*.01,l+f*.3,f*.1,0,Math.PI*2),e.fill(),e.fillStyle="rgba(255, 255, 200, 0.3)",e.beginPath(),e.arc(o+n-t*.01,l+f*.3,f*.2,0,Math.PI*2),e.fill()):(e.fillStyle="#FFECB3",e.beginPath(),e.arc(o+n-t*.01,l+f*.3,f*.06,0,Math.PI*2),e.fill(),e.strokeStyle="#FFD54F",e.stroke());const J=`${Math.floor(this.trainVelocity*1e3)} km/h`;if(e.fillStyle="#212121",e.font="12px Arial",e.textAlign="center",e.fillText(J,o+n/2,l+a+20),this.isRunning&&this.trainVelocity>.05){e.strokeStyle="rgba(255, 255, 255, 0.6)",e.lineWidth=1;const T=Math.floor(this.trainVelocity*100);for(let b=0;b<T;b++){const L=Math.random()*30+10,P=l+Math.random()*a;e.beginPath(),e.moveTo(o+n+10,P),e.lineTo(o+n+10+L,P),e.stroke()}}}drawParticles(e){e.save();for(const t of this.particles){const i=t.life/t.maxLife,s=t.color.split(","),n=s[0]+","+s[1]+","+s[2]+","+i*.7+")";e.fillStyle=n,e.beginPath(),e.arc(t.x,t.y,t.size*i,0,Math.PI*2),e.fill()}e.restore()}drawMagneticField(e,t,i){const s=i*.7,a=t*.2,n=i*.15,o=this.trainPosition/100*(t-a),r=this.levitationHeight/10*i*.08,h=s-n-r;e.strokeStyle=this.trackType==="EDS"?"#2979FF":"#FF9100",e.lineWidth=1.5*(this.fieldStrength/10+.5);const c=Math.floor(5+this.fieldStrength);for(let l=0;l<c;l++){const d=o+t*.05+l/c*a*.8;if(e.beginPath(),e.moveTo(d,h+n),this.isRunning){const g=this.time*3+l;if(this.trackType==="EDS"){const f=Math.sin(g)*i*.02*this.trainVelocity*5,S=d+f,v=h+n+(s-h-n)*.33,F=d-f,D=h+n+(s-h-n)*.66;e.bezierCurveTo(S,v,F,D,d,s)}else{const f=Math.sin(g)*i*.005;e.lineTo(d+f,s)}}else e.lineTo(d,s);e.globalAlpha=.3+.5*(this.fieldStrength/10),e.stroke(),e.globalAlpha=1}}drawInfoPanel(e,t,i){if(!this.isRunning)return;e.save(),e.fillStyle="rgba(255, 255, 255, 0.7)",this.roundRect(e,10,10,180,80,5),e.fill(),e.fillStyle="#212121",e.font="12px Arial",e.textAlign="left";const s=this.trackType==="EDS"?"电动悬浮系统":"电磁悬浮系统";e.fillText(`系统: ${s}`,20,30),e.fillText(`悬浮高度: ${this.levitationHeight.toFixed(1)} mm`,20,50),e.fillText(`速度: ${Math.floor(this.trainVelocity*1e3)} km/h`,20,70),e.restore()}roundRect(e,t,i,s,a,n){e.beginPath(),e.moveTo(t+n,i),e.lineTo(t+s-n,i),e.quadraticCurveTo(t+s,i,t+s,i+n),e.lineTo(t+s,i+a-n),e.quadraticCurveTo(t+s,i+a,t+s-n,i+a),e.lineTo(t+n,i+a),e.quadraticCurveTo(t,i+a,t,i+a-n),e.lineTo(t,i+n),e.quadraticCurveTo(t,i,t+n,i),e.closePath()}dispose(){this.pauseAnimation(),window.removeEventListener("resize",this.handleResize.bind(this))}}const vt=lt({name:"ElectromagneticEngines",setup(){const u=A(null),e=A(null),t=A(null),i=A(null),s=A(null),a=A(null),n=A("3d"),o=A("engine"),r=A("motor"),h=A(5),c=A(5),l=A(10),d=A(!0),g=A(!1),f=A({current:0,output:0,power:0,efficiency:0}),S=A(5),v=A(10),F=A(5),D=A("EDS"),E=A(!0),M=A(!1),V=A({levitationForce:0,propulsionForce:0,current:0,powerConsumption:0}),z=()=>{J(),n.value==="3d"?o.value==="engine"?T():b():o.value==="engine"?L():P()},q=()=>{J(),ht(()=>{n.value==="3d"?o.value==="engine"?T():b():o.value==="engine"?L():P()})},J=()=>{oe(),_(),t.value&&(t.value.dispose(),t.value=null),i.value&&(i.value.dispose(),i.value=null),s.value&&(s.value.dispose(),s.value=null),a.value&&(a.value.dispose(),a.value=null),g.value=!1,M.value=!1},T=()=>{u.value&&(t.value=new mt(u.value),t.value.setDataUpdateCallback(I=>{f.value=I}),t.value.createModel(),te())},b=()=>{u.value&&(i.value=new pt(u.value),i.value.setDataUpdateCallback(I=>{V.value=I}),i.value.createModel(),$())},L=()=>{e.value&&(s.value=new gt(e.value),s.value.setDataUpdateCallback(I=>{f.value=I}),te())},P=()=>{e.value&&(a.value=new ft(e.value),a.value.setDataUpdateCallback(I=>{V.value=I}),$())};ut(()=>{n.value==="3d"?o.value==="engine"?T():b():o.value==="engine"?L():P(),ee(),window.addEventListener("resize",ee)}),dt(()=>{J(),window.removeEventListener("resize",ee)});const ee=()=>{if(!e.value)return;const I=e.value.parentElement;I&&(e.value.width=I.clientWidth,e.value.height=I.clientHeight,n.value==="2d"&&(o.value==="engine"&&s.value?(s.value.dispose(),L()):o.value==="maglev"&&a.value&&(a.value.dispose(),P())))},te=()=>{n.value==="3d"&&t.value?t.value.setParameters({experimentType:r.value,magneticFieldStrength:h.value,coilTurns:c.value,rotationSpeed:l.value,showField:d.value}):n.value==="2d"&&s.value&&s.value.setParameters({experimentType:r.value,magneticFieldStrength:h.value,coilTurns:c.value,rotationSpeed:l.value,showField:d.value})},we=I=>{r.value=I,te(),re()},Se=()=>{n.value==="3d"&&t.value?(t.value.startAnimation(),g.value=!0):n.value==="2d"&&s.value&&(s.value.startAnimation(),g.value=!0)},oe=()=>{n.value==="3d"&&t.value?(t.value.pauseAnimation(),g.value=!1):n.value==="2d"&&s.value&&(s.value.pauseAnimation(),g.value=!1)},re=()=>{n.value==="3d"&&t.value?(t.value.resetExperiment(),g.value=!1):n.value==="2d"&&s.value&&(s.value.resetExperiment(),g.value=!1)},$=()=>{n.value==="3d"&&i.value?i.value.setParameters({height:S.value,speed:v.value,fieldStrength:F.value,trackType:D.value,showField:E.value}):n.value==="2d"&&a.value&&a.value.setParameters({height:S.value,speed:v.value,fieldStrength:F.value,trackType:D.value,showField:E.value})},Fe=I=>{D.value=I,$(),ne()},ie=()=>{n.value==="3d"&&i.value?(i.value.startAnimation(),M.value=!0):n.value==="2d"&&a.value&&(a.value.startAnimation(),M.value=!0)},_=()=>{n.value==="3d"&&i.value?(i.value.pauseAnimation(),M.value=!1):n.value==="2d"&&a.value&&(a.value.pauseAnimation(),M.value=!1)},ne=()=>{n.value==="3d"&&i.value?(i.value.resetSimulation(),M.value=!1):n.value==="2d"&&a.value&&(a.value.resetSimulation(),M.value=!1)};return Ie([r],()=>{re()}),Ie([D],()=>{ne()}),{modelContainer:u,canvasContainer:e,viewMode:n,simulationType:o,switchViewMode:q,switchSimulationType:z,experimentType:r,magneticFieldStrength:h,coilTurns:c,rotationSpeed:l,showField:d,isRunning:g,experimentData:f,updateParameters:te,setExperimentType:we,startExperiment:Se,pauseExperiment:oe,resetExperiment:re,maglevHeight:S,maglevSpeed:v,maglevFieldStrength:F,maglevTrackType:D,maglevShowField:E,isMaglevRunning:M,maglevData:V,updateMaglevParameters:$,setMaglevTrackType:Fe,startMaglevSimulation:ie,pauseMaglevSimulation:_,resetMaglevSimulation:ne}}}),wt={class:"electromagnetic-engines-page"},St={class:"container"},Ft={class:"simulation-container"},yt={class:"simulation-panel"},Mt={class:"simulation-selector"},Et={class:"view-panel"},Ct={class:"view-selector"},Dt={class:"visualization-container"},At={ref:"modelContainer",class:"model-container"},Tt={ref:"canvasContainer",class:"canvas-container",width:"600",height:"400"},kt={class:"controls-panel"},bt={key:0},Pt={class:"control-group"},Bt={class:"parameter-controls"},Vt={class:"parameter-slider"},Rt={class:"parameter-slider"},zt={class:"parameter-slider"},It={class:"parameter-checkbox"},Gt={class:"control-actions"},Lt={class:"results-panel"},Ut={class:"data-grid"},Ht={class:"data-item"},Wt={class:"data-label"},qt={class:"data-value"},_t={class:"data-item"},Xt={class:"data-label"},Nt={class:"data-value"},Yt={class:"data-item"},$t={class:"data-value"},Ot={class:"data-item"},Zt={class:"data-value"},Jt={key:1},Kt={class:"control-group"},Qt={class:"parameter-controls"},jt={class:"parameter-slider"},xt={class:"parameter-slider"},ei={class:"parameter-slider"},ti={class:"parameter-checkbox"},ii={class:"control-actions"},ni={class:"results-panel"},si={class:"data-grid"},ai={class:"data-item"},oi={class:"data-value"},ri={class:"data-item"},li={class:"data-value"},ui={class:"data-item"},di={class:"data-value"},hi={class:"data-item"},ci={class:"data-value"},mi={class:"theory-section"},pi={key:0},gi={key:0},fi={key:1},vi={key:1},wi={key:0},Si={key:1};function Fi(u,e,t,i,s,a){const n=ae("el-radio-button"),o=ae("el-radio-group"),r=ae("el-radio"),h=ae("el-slider"),c=ae("el-checkbox"),l=ae("el-button");return Z(),O("div",wt,[p("div",St,[e[41]||(e[41]=p("div",{class:"page-header"},[p("h1",{class:"page-title"},[G("电磁引擎 "),p("span",{class:"page-subtitle"},"Electromagnetic Engines")]),p("p",{class:"page-description"}," 通过可视化模拟，探索电磁感应原理及其在电动机、发电机和磁悬浮列车中的应用。 学习不同类型电磁引擎的工作原理和关键参数对其性能的影响。 ")],-1)),p("div",Ft,[p("div",yt,[p("div",Mt,[y(o,{modelValue:u.simulationType,"onUpdate:modelValue":e[0]||(e[0]=d=>u.simulationType=d),onChange:u.switchSimulationType},{default:k(()=>[y(n,{label:"engine"},{default:k(()=>e[12]||(e[12]=[G("电磁引擎")])),_:1}),y(n,{label:"maglev"},{default:k(()=>e[13]||(e[13]=[G("磁悬浮列车")])),_:1})]),_:1},8,["modelValue","onChange"])]),p("div",Et,[p("div",Ct,[y(o,{modelValue:u.viewMode,"onUpdate:modelValue":e[1]||(e[1]=d=>u.viewMode=d),onChange:u.switchViewMode},{default:k(()=>[y(r,{label:"2d"},{default:k(()=>e[14]||(e[14]=[G("2D视图")])),_:1}),y(r,{label:"3d"},{default:k(()=>e[15]||(e[15]=[G("3D视图")])),_:1})]),_:1},8,["modelValue","onChange"])]),p("div",Dt,[Ge(p("div",At,null,512),[[Le,u.viewMode==="3d"]]),Ge(p("canvas",Tt,null,512),[[Le,u.viewMode==="2d"]])])]),p("div",kt,[u.simulationType==="engine"?(Z(),O("div",bt,[e[26]||(e[26]=p("h3",null,"电磁引擎实验",-1)),p("div",Pt,[e[18]||(e[18]=p("label",null,"实验类型：",-1)),y(o,{modelValue:u.experimentType,"onUpdate:modelValue":e[2]||(e[2]=d=>u.experimentType=d),onChange:u.setExperimentType},{default:k(()=>[y(r,{label:"motor"},{default:k(()=>e[16]||(e[16]=[G("电动机")])),_:1}),y(r,{label:"generator"},{default:k(()=>e[17]||(e[17]=[G("发电机")])),_:1})]),_:1},8,["modelValue","onChange"])]),p("div",Bt,[p("div",Vt,[p("span",null,"磁场强度 ("+R(u.magneticFieldStrength)+")",1),y(h,{modelValue:u.magneticFieldStrength,"onUpdate:modelValue":e[3]||(e[3]=d=>u.magneticFieldStrength=d),min:1,max:10,step:1,onInput:u.updateParameters},null,8,["modelValue","onInput"])]),p("div",Rt,[p("span",null,"线圈匝数 ("+R(u.coilTurns)+")",1),y(h,{modelValue:u.coilTurns,"onUpdate:modelValue":e[4]||(e[4]=d=>u.coilTurns=d),min:2,max:8,step:1,onInput:u.updateParameters},null,8,["modelValue","onInput"])]),p("div",zt,[p("span",null,"旋转速度 ("+R(u.rotationSpeed)+")",1),y(h,{modelValue:u.rotationSpeed,"onUpdate:modelValue":e[5]||(e[5]=d=>u.rotationSpeed=d),min:1,max:20,step:1,onInput:u.updateParameters},null,8,["modelValue","onInput"])]),p("div",It,[y(c,{modelValue:u.showField,"onUpdate:modelValue":e[6]||(e[6]=d=>u.showField=d),onChange:u.updateParameters},{default:k(()=>e[19]||(e[19]=[G("显示磁场")])),_:1},8,["modelValue","onChange"])])]),p("div",Gt,[y(l,{type:"primary",disabled:u.isRunning,onClick:u.startExperiment},{default:k(()=>e[20]||(e[20]=[G(" 开始 ")])),_:1},8,["disabled","onClick"]),y(l,{disabled:!u.isRunning,onClick:u.pauseExperiment,type:"warning"},{default:k(()=>e[21]||(e[21]=[G(" 暂停 ")])),_:1},8,["disabled","onClick"]),y(l,{onClick:u.resetExperiment,type:"info"},{default:k(()=>e[22]||(e[22]=[G("重置")])),_:1},8,["onClick"])]),p("div",Lt,[e[25]||(e[25]=p("h4",null,"实验数据：",-1)),p("div",Ut,[p("div",Ht,[p("span",Wt,R(u.experimentType==="motor"?"电流 (A)":"转速 (RPM)")+":",1),p("span",qt,R(u.experimentData.current.toFixed(2)),1)]),p("div",_t,[p("span",Xt,R(u.experimentType==="motor"?"转矩 (N⋅m)":"电动势 (V)")+":",1),p("span",Nt,R(u.experimentData.output.toFixed(2)),1)]),p("div",Yt,[e[23]||(e[23]=p("span",{class:"data-label"},"功率 (W):",-1)),p("span",$t,R(u.experimentData.power.toFixed(2)),1)]),p("div",Ot,[e[24]||(e[24]=p("span",{class:"data-label"},"效率 (%):",-1)),p("span",Zt,R(u.experimentData.efficiency.toFixed(2)),1)])])])])):ge("",!0),u.simulationType==="maglev"?(Z(),O("div",Jt,[e[39]||(e[39]=p("h3",null,"磁悬浮列车实验",-1)),p("div",Kt,[e[29]||(e[29]=p("label",null,"轨道类型：",-1)),y(o,{modelValue:u.maglevTrackType,"onUpdate:modelValue":e[7]||(e[7]=d=>u.maglevTrackType=d),onChange:u.setMaglevTrackType},{default:k(()=>[y(r,{label:"EDS"},{default:k(()=>e[27]||(e[27]=[G("EDS (电动悬浮)")])),_:1}),y(r,{label:"EMS"},{default:k(()=>e[28]||(e[28]=[G("EMS (电磁悬浮)")])),_:1})]),_:1},8,["modelValue","onChange"])]),p("div",Qt,[p("div",jt,[p("span",null,"悬浮高度 ("+R(u.maglevHeight)+")",1),y(h,{modelValue:u.maglevHeight,"onUpdate:modelValue":e[8]||(e[8]=d=>u.maglevHeight=d),min:1,max:10,step:1,onInput:u.updateMaglevParameters},null,8,["modelValue","onInput"])]),p("div",xt,[p("span",null,"列车速度 ("+R(u.maglevSpeed)+")",1),y(h,{modelValue:u.maglevSpeed,"onUpdate:modelValue":e[9]||(e[9]=d=>u.maglevSpeed=d),min:0,max:30,step:1,onInput:u.updateMaglevParameters},null,8,["modelValue","onInput"])]),p("div",ei,[p("span",null,"磁场强度 ("+R(u.maglevFieldStrength)+")",1),y(h,{modelValue:u.maglevFieldStrength,"onUpdate:modelValue":e[10]||(e[10]=d=>u.maglevFieldStrength=d),min:1,max:10,step:1,onInput:u.updateMaglevParameters},null,8,["modelValue","onInput"])]),p("div",ti,[y(c,{modelValue:u.maglevShowField,"onUpdate:modelValue":e[11]||(e[11]=d=>u.maglevShowField=d),onChange:u.updateMaglevParameters},{default:k(()=>e[30]||(e[30]=[G("显示磁场")])),_:1},8,["modelValue","onChange"])])]),p("div",ii,[y(l,{type:"primary",disabled:u.isMaglevRunning,onClick:u.startMaglevSimulation},{default:k(()=>e[31]||(e[31]=[G(" 开始 ")])),_:1},8,["disabled","onClick"]),y(l,{disabled:!u.isMaglevRunning,onClick:u.pauseMaglevSimulation,type:"warning"},{default:k(()=>e[32]||(e[32]=[G(" 暂停 ")])),_:1},8,["disabled","onClick"]),y(l,{onClick:u.resetMaglevSimulation,type:"info"},{default:k(()=>e[33]||(e[33]=[G("重置")])),_:1},8,["onClick"])]),p("div",ni,[e[38]||(e[38]=p("h4",null,"实验数据：",-1)),p("div",si,[p("div",ai,[e[34]||(e[34]=p("span",{class:"data-label"},"悬浮力 (N):",-1)),p("span",oi,R(u.maglevData.levitationForce.toFixed(2)),1)]),p("div",ri,[e[35]||(e[35]=p("span",{class:"data-label"},"推进力 (N):",-1)),p("span",li,R(u.maglevData.propulsionForce.toFixed(2)),1)]),p("div",ui,[e[36]||(e[36]=p("span",{class:"data-label"},"电流 (A):",-1)),p("span",di,R(u.maglevData.current.toFixed(2)),1)]),p("div",hi,[e[37]||(e[37]=p("span",{class:"data-label"},"能耗 (kW):",-1)),p("span",ci,R(u.maglevData.powerConsumption.toFixed(2)),1)])])])])):ge("",!0)])]),p("div",mi,[e[40]||(e[40]=p("h3",null,"原理解析",-1)),u.simulationType==="engine"?(Z(),O("div",pi,[p("h4",null,R(u.experimentType==="motor"?"电动机":"发电机")+"工作原理",1),u.experimentType==="motor"?(Z(),O("p",gi," 电动机利用通电线圈在磁场中受到的洛伦兹力将电能转换为机械能。当电流流过位于磁场中的线圈时， 线圈两侧会受到大小相等、方向相反的力，形成力矩使转子旋转。通过电刷和换向器实现电流方向的 周期性变化，保持转子持续单向旋转。 ")):(Z(),O("p",fi," 发电机是电动机的逆过程，利用电磁感应原理将机械能转换为电能。当磁铁相对于线圈旋转时， 线圈中的磁通量发生变化，根据法拉第电磁感应定律，线圈中会感应出电动势，连接到外电路后 将产生电流，实现能量转换。 "))])):ge("",!0),u.simulationType==="maglev"?(Z(),O("div",vi,[p("h4",null,R(u.maglevTrackType==="EDS"?"电动悬浮系统(EDS)":"电磁悬浮系统(EMS)"),1),u.maglevTrackType==="EDS"?(Z(),O("p",wi," 电动悬浮系统(EDS)利用电磁感应原理工作。当列车上的超导体高速运动经过轨道上的导体线圈时， 在线圈中感应出涡流，产生与列车运动方向相反的磁场，从而产生斥力使列车悬浮。这种系统需要 一定的初始速度才能产生足够的悬浮力，具有稳定性好、悬浮高度大的特点。 ")):(Z(),O("p",Si," 电磁悬浮系统(EMS)利用电磁吸力原理工作。列车底部的电磁铁通电后产生磁场，吸引轨道中的 导轨，通过精确控制电流大小来维持恒定的悬浮高度。这种系统可以实现静止悬浮，但需要复杂的 控制系统来保持稳定，悬浮高度较小。 "))])):ge("",!0)])])])])}const Di=ct(vt,[["render",Fi],["__scopeId","data-v-ed4f6b34"]]);export{Di as default};
